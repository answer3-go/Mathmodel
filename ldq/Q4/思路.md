### **问题四：基于粒子群优化的三机协同策略建模 (完整版)**

#### **1. 问题重述**

本问题的核心目标是：为三架无人机（FY1, FY2, FY3），各自规划独立的飞行与投放策略，协同对抗来袭的导弹（M1）。需确定**每架无人机的飞行速度与方向**、**各自的投放时刻**以及一个**统一的引信延迟**，使得由三枚烟幕弹共同形成的遮蔽效果，对真目标的**有效遮蔽总时长达到最大**。

#### **2. 模型假设**

(与前文一致)

1. 运动模型简化 (匀速直线、抛体、匀速下沉)。
2. 遮蔽判定简化 (保护真目标几何中心点 `(0, 200, 5)`)。
3. 瞬时形成与均匀性 (半径10m球体，持续20s)。
4. 环境因素忽略。

#### **3. 符号说明**

| 符号                          | 含义                                                  |
| :---------------------------- | :---------------------------------------------------- |
| $j$                         | 无人机编号,$j \in \{1, 2, 3\}$                      |
| $\vec{x}$                   | 10维决策变量向量                                      |
| $v_j, \alpha_j, t_{drop,j}$ | 第$j$ 架无人机的速度、方向角、投放时刻              |
| $\Delta t_{delay}$          | 统一的引信延迟时间 (为简洁，下文用$t_{delay}$ 表示) |
| $f(\vec{x})$                | 目标函数，即总遮蔽时长$T_{total}(\vec{x})$          |
| $\vec{P}_{uav\_start, j}$   | 第$j$ 架无人机的初始位置向量                        |

#### **4. 模型建立**

这是一个高维度的非线性优化问题。我们将构建一个包含决策变量、目标函数和约束条件的完整优化模型，并采用经过优化的粒子群算法（PSO）进行求解。

##### **4.1 决策变量 (Decision Variables)**

为完整描述三架无人机的协同策略，并基于工程实际进行合理简化，我们将决策变量向量 $\vec{x}$ 定义为一个 **10维向量**：

$$
\vec{x} = [
\underbrace{v_1, \alpha_1, t_{drop,1}}_{\text{FY1策略}},
\underbrace{v_2, \alpha_2, t_{drop,2}}_{\text{FY2策略}},
\underbrace{v_3, \alpha_3, t_{drop,3}}_{\text{FY3策略}},
\underbrace{\Delta t_{delay}}_{\text{统一引信延迟}}
]
$$

##### **4.2 目标函数 (Objective Function)**

我们的优化目标是最大化有效遮蔽总时长 $T_{total}$。$T_{total}$ 是一个依赖于10维决策变量 $\vec{x}$ 的函数 $f(\vec{x})$。

$$
\text{Maximize: } f(\vec{x}) = T_{total}(\vec{x})
$$

$T_{total}(\vec{x})$ 通过对一个瞬时遮蔽状态函数 $V(t, \vec{x})$ 进行数值积分（离散求和）得到：

$$
T_{total}(\vec{x}) \approx \sum_{i=0}^{N} V(t_i, \vec{x}) \cdot \Delta t
$$

其中，$t_i = i \cdot \Delta t$。

瞬时遮蔽状态函数 $V(t, \vec{x})$ 的计算，依赖于一个由**时空运动方程**和**几何判定规则**构成的复杂逻辑。在时刻 $t_i$，只要三朵烟幕云中**至少有一朵**形成了遮蔽，该时刻就有效。其数学表达为一个**逻辑或 (OR)** 关系：

$$
V(t_i, \vec{x}) = \max_{j \in \{1,2,3\}} \left( \text{IsVeiledByUAV}_j(t_i, \vec{x}) \right)
$$

其中，$\text{IsVeiledByUAV}_j(t_i, \vec{x})$ 是一个布尔函数（取值为0或1），用于判断第 $j$ 架无人机投放的烟幕弹在时刻 $t_i$ 是否形成了有效遮蔽。

下面，我们详细展开 $\text{IsVeiledByUAV}_j(t_i, \vec{x})$ 的计算所需的**核心数学公式**：

**a) 策略参数提取**:
对于给定的10维向量 $\vec{x}$ 和无人机编号 $j$，我们首先提取出该无人机专属的策略参数：

* $v_j, \alpha_j, t_{drop,j}$ 从 $\vec{x}$ 的对应位置提取。
* $\Delta t_{delay}$ 从 $\vec{x}$ 的最后一个位置提取。
* 无人机初始位置 $\vec{P}_{uav\_start, j}$ 从题目给定的常量中提取。

**b) 时空运动方程**:

1. **无人机 $j$ 的速度向量**:
   $$
   \vec{v}_{uav,j} = (v_j \cdot \cos(\alpha_{j,rad}), v_j \cdot \sin(\alpha_{j,rad}), 0)
   $$
2. **烟幕弹 $j$ 的起爆时刻**:
   $$
   t_{detonate,j} = t_{drop,j} + \Delta t_{delay}
   $$
3. **烟幕弹 $j$ 的起爆点位置**:
   $$
   \vec{P}_{detonate,j} = (\vec{P}_{uav\_start, j} + \vec{v}_{uav,j} \cdot t_{drop,j}) + \vec{v}_{uav,j} \cdot \Delta t_{delay} + \frac{1}{2} \vec{g} \cdot (\Delta t_{delay})^2
   $$
4. **烟幕云 $j$ 在时刻 $t_i$ 的球心位置**:
   $$
   \vec{P}_{cloud,j}(t_i) = \vec{P}_{detonate,j} + \vec{v}_{cloud} \cdot (t_i - t_{detonate,j})
   $$
5. **导弹在时刻 $t_i$ 的位置**:
   $$
   \vec{P}_{missile}(t_i) = \vec{P}_{missile\_start} + \vec{v}_{missile} \cdot t_i
   $$

**c) 几何判定规则**:
$\text{IsVeiledByUAV}_j(t_i, \vec{x})$ 的最终值为1，当且仅当以下两个条件**同时满足**：

1. **时间有效性**: $t_{detonate,j} \le t_i < t_{detonate,j} + 20$
2. **空间有效性**: 连接 $\vec{P}_{missile}(t_i)$ 与真目标关键点 $\vec{P}_{target}$ 的线段，与以 $\vec{P}_{cloud,j}(t_i)$ 为球心、半径 $R_{smoke}=10$m 的球体**相交**。

##### **4.3 约束条件 (Constraints)**

决策变量 $\vec{x}$ 的每一维都必须满足其物理限制：

$$
\begin{align*}
70 &\le v_j \le 140 && \text{for } j=1,2,3 \\
0 &\le \alpha_j < 360 && \text{for } j=1,2,3 \\
t_{drop,j} &\ge 0.1 && \text{for } j=1,2,3 \\
\Delta t_{delay} &\ge 0.1
\end{align*}
$$

同时为每个变量设置合理的搜索上限，如 $t_{drop,j} \le 40$s, $\Delta t_{delay} \le 15$s。

#### **5. 模型求解方法**

我们采用经过**启发式种子注入**和**向量化随机因子**增强的**粒子群优化算法 (Enhanced PSO)** 来求解这个10维优化问题。

* **算法原理**: 通过模拟粒子群体的社会协作行为，在解空间中进行迭代搜索。
* **核心数学公式**:
  1. **速度更新**:

     $$
     \vec{v}_{i}(k+1) = w \cdot \vec{v}_{i}(k) + c_1 \cdot \vec{r}_1 \cdot (\vec{p}_{best, i} - \vec{x}_{i}(k)) + c_2 \cdot \vec{r}_2 \cdot (\vec{g}_{best} - \vec{x}_{i}(k))
     $$

     其中，$\vec{r}_1, \vec{r}_2$ 为10维的、各分量在 $$ 内独立生成的随机向量。
  2. **位置更新**:

     $$
     \vec{x}_{i}(k+1) = \vec{x}_{i}(k) + \vec{v}_{i}(k+1)
     $$
* **启发式种子注入**: 为克服高维空间中随机初始化难以找到有效解的问题，我们将问题三的6维最优解进行**逻辑扩展**，构造出一个高质量的10维种子策略，并将其植入PSO的初始种群，为算法提供一个高起点的、包含协同智慧的进化方向。
* **求解步骤**: 算法从包含种子的初始种群开始，通过反复迭代速度和位置更新公式，并调用目标函数 $f(\vec{x})$ 进行适应度评估，最终收敛得到最优解 $\vec{x}^*$ 和对应的最大遮蔽时长 $f(\vec{x}^*)$。
