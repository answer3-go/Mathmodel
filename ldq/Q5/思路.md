### **问题五：五机三弹对抗三导弹的综合策略建模**

#### **1. 问题重述**

本问题的核心目标是：利用**全部5架无人机** (FY1-FY5)，每架无人机最多可投放**3枚**烟幕弹，协同对抗来袭的**3枚导弹** (M1, M2, M3)。设计一套完整的投放策略，使得对**所有三枚导弹**的总有效遮蔽时长**尽可能长**。

**关键变化**:

* **对抗关系**: 从 `多对一` (问题四) 变为 `多对多`。
* **资源约束**: 每架无人机有 `0-3` 枚弹药的限制，总资源为15枚弹。
* **目标函数**: 需要重新定义，以衡量对**所有三个目标**的总体拦截效果。
* **任务分配**: **“谁去打谁？”** 成为了一个必须在优化前解决的核心问题。

#### **2. 核心思路：分层优化——“先定大计，再优细节”**

直接对一个可能包含 `5 * (v, a, t1, t2, t3, delay) = 30+` 维变量的巨大空间进行一体化优化，是不可行的。我们必须采用**分层优化 (Hierarchical Optimization)** 的思想，将这个复杂问题分解成两个更易于处理的、相互关联的子问题：

**顶层决策：任务规划与资源分配 (宏观战术)**

1. **威胁评估**: 首先，我们需要对三枚来袭导弹进行量化评估，判断它们的**威胁等级**。哪个导弹最紧急？哪个导弹最具威胁？
2. **任务分配**: 根据威胁评估和无人机的位置态势，决定**“哪个无人机（或无人机编队）去负责拦截哪个导弹”**。
3. **资源分配**: 决定为每一个拦截任务，分配**多少枚烟幕弹**。

**底层决策：协同策略优化 (微观执行)**

* 一旦顶层的“大计”已定（例如，决定由FY1和FY4组成编队，用3枚烟幕弹去拦截M1），问题就**降维**成了一个或多个类似问题三/四的、维度更低的**“小编队协同优化”**问题。
* 然后，我们就可以调用我们已经打磨成熟的PSO求解器，为每一个小编队**独立地**求解其最优的飞行和投放策略。

---

### **3. 模型建立与核心数学公式**

#### **第 I 阶段：顶层决策 - 任务规划与资源分配模型**

**3.1 威胁评估模型**

* **目的**: 为每个导弹 $k \in \{1, 2, 3\}$ 计算一个威胁值 $W_k$。
* **评估维度**:
  * **时间威胁**: 导弹到达真目标附近所需的时间 $T_{impact, k}$。时间越短，威胁越高。
  * **空间威胁**: 导弹的飞行轨迹与真目标的最小距离 $D_{min, k}$。距离越近，威胁越高。
* **核心公式**: 我们可以定义一个综合威胁指数 $W_k$，它是时间和空间威胁的加权组合：
  $$
  W_k = \lambda_T \cdot \frac{1}{T_{impact, k}} + \lambda_D \cdot \frac{1}{D_{min, k}}
  $$

  * $T_{impact, k}$ 和 $D_{min, k}$ 可以通过**调用时空运动模型**精确计算。
  * $\lambda_T, \lambda_D$ 是权重系数，需要根据战术理解进行设定（例如，时间威胁更重要，则 $\lambda_T > \lambda_D$）。

**3.2 任务分配与资源分配模型**

* **目的**: 这是一个经典的**指派问题 (Assignment Problem)**。我们需要确定一个分配方案，将5架无人机和15枚弹药，分配给3个拦截任务。
* **简化策略 (启发式规则)**: 在比赛的有限时间内，建立并求解一个复杂的整数规划模型可能不现实。我们采用一个高效的**启发式分配规则**：

  1. **按威胁等级分配**: 优先为威胁等级最高的导弹分配资源。
  2. **就近原则**: 对于一个给定的导弹目标，优先指派距离它“成本”最低的无人机。无人机 $j$ 对导弹 $k$ 的成本 $C_{jk}$ 可以定义为无人机以最大速度飞抵导弹 $k$ 关键拦截区域所需的时间。
  3. **资源饱和原则**: 为每个拦截任务分配足够的弹药。一个简单的策略是，为威胁最高的导弹分配更多的无人机和弹药。
* **示例分配流程**:

  1. 计算三枚导弹的威胁值 $W_1, W_2, W_3$，并排序。假设 $W_1 > W_2 > W_3$。
  2. **为M1分配**: 计算所有5架无人机到M1拦截区的成本 $C_{j1}$，选择成本最低的2架（例如FY1, FY4）组成**编队1**，并为该编队分配3枚弹药。
  3. **为M2分配**: 在剩下的3架无人机中，计算到M2拦截区的成本 $C_{j2}$，选择成本最低的2架（例如FY2, FY5）组成**编队2**，分配3枚弹药。
  4. **为M3分配**: 将剩下的1架无人机（FY3）组成**编队3**，分配2枚弹药。

  * 这个分配结果 `{(FY1,FY4)->M1, 3弹}, {(FY2,FY5)->M2, 3弹}, {FY3->M3, 2弹}` 就是我们顶层决策的输出。

#### **第 II 阶段：底层决策 - 小编队协同策略优化**

现在，原来的大问题被分解成了三个**独立的**子问题。我们以“编队1拦截M1”为例。

**3.3 子问题优化模型**

* **问题定义**: 为无人机FY1和FY4，规划各自独立的飞行与投放策略，协同使用3枚烟幕弹，最大化对**导弹M1**的有效遮蔽时长。
* **决策变量**:

  * 这是一个**多对一、多弹药**的问题。我们需要为FY1和FY4都定义飞行策略 `(v, a)`。
  * 我们还需要决定这3枚弹药，**如何在这两架无人机之间分配**（比如FY1投1枚，FY4投2枚），以及它们各自的投放时机。
  * 为了简化，我们可以预先固定弹药分配（例如，成本更低的FY1投2枚，FY4投1枚）。
  * 最终的决策变量向量 $\vec{x}_{sub1}$ 将包含：
    $$
    \vec{x}_{sub1} = [
    \underbrace{v_1, \alpha_1}_{\text{FY1飞行}}, \underbrace{v_4, \alpha_4}_{\text{FY4飞行}},
    \underbrace{t_{drop,1.1}, t_{drop,1.2}}_{\text{FY1投放时间}}, \underbrace{t_{drop,4.1}}_{\text{FY4投放时间}},
    \underbrace{\Delta t_{delay}}_{\text{统一引信}}
    ]
    $$

    这是一个8维的优化问题。
* **目标函数**:

  * $f_{sub1}(\vec{x}_{sub1}) = T_{total, M1}(\vec{x}_{sub1})$。计算逻辑与问题三/四完全一样，只是现在需要在一个循环中，判断这3枚来自不同无人机的烟幕弹是否对**M1**形成了“逻辑或”遮蔽。
* **模型求解**:

  * 我们**复用**我们的**增强型PSO求解器**，来求解这个8维的子问题。
  * **种子注入**: 我们可以将问题四的最优策略（FY1单机拦截M1）作为这个子问题的一个基础种子。

**3.4 最终解的合成**

1. 我们对每一个子问题（编队1 vs M1, 编队2 vs M2, 编队3 vs M3）都独立地运行一次PSO优化，得到各自的最优策略 $\vec{x}_{sub1}^*, \vec{x}_{sub2}^*, \vec{x}_{sub3}^*$。
2. 将这三组最优策略**拼接**起来，就构成了整个问题五的最终解决方案。
3. 最终的目标函数值，可以是三个子问题最优遮蔽时长的**加权和**（权重为导弹的威胁值），或者就是**简单求和**。
   $$
   T_{total, Q5} = \sum_{k=1}^{3} W_k \cdot f_{sub,k}(\vec{x}_{sub,k}^*) \quad \text{或} \quad T_{total, Q5} = \sum_{k=1}^{3} f_{sub,k}(\vec{x}_{sub,k}^*)
   $$

这种**“分而治之” (Divide and Conquer)** 的分层优化策略，是解决类似问题五这种大规模、复杂协同优化问题的最有效、最科学的途径。它将一个几乎无法直接求解的超高维问题，成功地降维成了若干个我们已经有能力解决的、更小规模的子问题。
